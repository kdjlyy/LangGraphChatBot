## ğŸ‰ News

- [x] [2025.05.02] ğŸ¯ğŸ“¢å¯è‡ªå®šä¹‰ç½‘é¡µæœç´¢è¿”å›çš„ç½‘é¡µæ•°é‡ï¼›ç”¨æˆ·æŸ¥è¯¢å…³é”®å­—æå–é€»è¾‘ä¼˜åŒ–ï¼›å‘é‡å¬å›åæ·»åŠ  rerank æ“ä½œã€‚
- [x] [2025.04.29] ğŸ¯ğŸ“¢ç°å·²æ¥å…¥ç«å±±æ–¹èˆŸï¼ˆARKï¼‰ï¼Œæ”¯æŒé€‰æ‹©`doubao-embedding-text-240715`å’Œ`doubao-embedding-large-text-240915`
Embedding æ¨¡å‹ï¼Œåˆ†åˆ«å¯¹åº” 2560 å’Œ 4096 å‘é‡ç»´åº¦ã€‚

---

## ç®€ä»‹

> é¡¹ç›®æ•ˆæœå±•ç¤º: [LangGraphChatBot](http://14.103.121.86:8090/)
> <table>
> <tr>
> <td style="text-align: center;"><img src="./resources/websearch.png" width="600"/></td>
> <td style="text-align: center;"><img src="./resources/file_retrival.png" width="600"/></td>
> </tr>
> </table>

LangGraphChatBot æ˜¯åŸºäº LangChain å’Œ LangGraph çš„ AI èŠå¤©æœºå™¨äººï¼Œå¯ä»¥ç”¨äºå›ç­”é—®é¢˜ã€ç”Ÿæˆæ–‡ç« ã€è”ç½‘æœç´¢ã€å¤„ç†æ–‡ä»¶ç­‰ã€‚è¯¥åº”ç”¨å…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š

1. æ ¹æ®å¯¹è¯ç±»å‹å°†è¯·æ±‚è·¯ç”±åˆ°é€‚å½“çš„å¤„ç†èŠ‚ç‚¹
2. æ”¯æŒè”ç½‘æœç´¢ï¼ˆåŸºäº `Tavily API`ï¼‰ï¼Œè·å–å®æ—¶ä¿¡æ¯
3. æ ¹æ®é—®é¢˜å’Œå¯¹è¯å†å²ç”Ÿæˆä¼˜åŒ–çš„æœç´¢æç¤ºè¯ï¼Œä¼˜åŒ–æœç´¢ç²¾åº¦
4. åˆ©ç”¨ç¼–ç¨‹ä¸“ç”¨çš„ `LLM` è§£å†³ä»£ç ç›¸å…³é—®é¢˜ï¼Œæ”¯æŒè¿ç»­å¯¹è¯ã€æ”¯æŒæµå¼å›ç­”å±•ç¤º
5. æ”¯æŒæ–‡ä»¶ä¸Šä¼ ä¸ `RAG` å¤„ç†ï¼Œåˆ‡åˆ†æ–‡æ¡£ï¼Œè½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼ŒåŸºäºæä¾›çš„æ–‡æ¡£å†…å®¹å’Œç”¨æˆ·æé—®ï¼Œè¿›è¡Œç›¸ä¼¼åº¦æœç´¢å’Œ `rerank` ä¼˜åŒ–ï¼Œæ€»ç»“ç”Ÿæˆç­”æ¡ˆ
6. å¤šä¸ª `LLM` åŸºåº§æ¨¡å‹åŠ `Embedding` æ¨¡å‹å¯ä¾›é€‰æ‹©ï¼Œæ”¯æŒåœ¨çº¿è°ƒèŠ‚æ¨¡å‹å‚æ•°
7. `TODO:` æ¥å…¥ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¦‚å¤©æ°”ã€ç¿»è¯‘ç­‰ï¼Œæ”¯æŒæ›´å¤šåŠŸèƒ½
8. `TODO:` å½“å‰è”ç½‘æœç´¢é“¾è·¯å›å¤è¾ƒæ…¢ï¼Œä¼˜åŒ–å“åº”æ—¶é—´

> ğŸ‰ æ›´å¤š Agent ä¸ªäººé¡¹ç›®è¯·å‚è€ƒï¼š[Agent](https://github.com/kdjlyy/Agent)

## å¿«é€Ÿå¼€å§‹

ä»¥ä¸‹æŒ‡å—å°†å¸®åŠ©ä½ åœ¨æœ¬åœ°æœºå™¨ä¸Šå®‰è£…å’Œè¿è¡Œè¯¥é¡¹ç›®ï¼Œè¿›è¡Œæœ¬åœ°å¯¹è¯ã€‚

1. å…‹éš†ä»“åº“

	```bash
	git clone git@github.com:kdjlyy/LangGraphChatBot.git
	cd LangGraphChatBot
	```

2. å®‰è£…ä¾èµ–

	æœ¬é¡¹ç›®æ¨èä½¿ç”¨ uv ç®¡ç†è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–ï¼Œå¦‚æœæ²¡æœ‰å®‰è£… uv ä¹Ÿå¯ä»¥ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ [requirements.txt](./requirements.txt) æ–‡ä»¶æ‹‰å–ç›¸å…³ä¾èµ–ã€‚uv çš„å®‰è£…ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

	```bash
	# å®‰è£… uv
	pip install uv
	# æŸ¥çœ‹ uv ç‰ˆæœ¬
	uv --version
	# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
	uv venv
	# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
	source .venv/bin/activate
	# å®‰è£…ä¾èµ–
	uv sync
	```
	
	æ‹‰å– `python` å’Œ `torch` ç›¸å…³åŒ…æ—¶å¯èƒ½ä¼šé‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å›½å†…æºã€‚
	
3. é¡¹ç›®é…ç½®

	é¡¹ç›®ä»æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶è¯»å–é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¨¡å‹è·¯å¾„ã€æ¨¡å‹å‚æ•°ã€API å¯†é’¥ç­‰ã€‚å¦‚æœéœ€è¦ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥ä¿®æ”¹ `.env` æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šé…ç½®ä¿¡æ¯ã€‚ç›¸å…³é…ç½®é¡¹çš„æè¿°è¯¦è§ï¼š[.env.example](./.env.example) æ–‡ä»¶æ³¨é‡Šã€‚

	```bash
	# åˆ›å»º .env æ–‡ä»¶
	cp .env.example .env
	```

4. æ§åˆ¶å°è¿è¡Œé¡¹ç›®

	```bash
	# è¿è¡Œé¡¹ç›®
	uv run main.py
	```

	ç°åœ¨ä½ å¯ä»¥åœ¨æ§åˆ¶å°è¾“å…¥é—®é¢˜ï¼Œç­‰å¾…æ¨¡å‹è¿”å›ç»“æœã€‚

5. ä½¿ç”¨ Streamlit è¿è¡Œé¡¹ç›®

	```bash
	# è¿è¡Œé¡¹ç›®
	streamlit run app.py
	```

## é¡¹ç›®ç»“æ„

é¡¹ç›®çš„ä¸»è¦ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
.
â”œâ”€â”€ chains          # æ™ºèƒ½ä½“
â”‚ â”œâ”€â”€ generate.py
â”‚ â”œâ”€â”€ models.py
â”‚ â””â”€â”€ summary.py
â”œâ”€â”€ embedding       # embedding å…¼å®¹
â”‚ â”œâ”€â”€ ark_embedding.py  # ç«å±±æ–¹èˆŸçš„ embedding
â”‚ â””â”€â”€ base_embedding.py # embedding çš„åŸºç±»
â”œâ”€â”€ graph           # å›¾ç»“æ„
â”‚ â”œâ”€â”€ graph.py
â”‚ â””â”€â”€ graph_state.py
â”œâ”€â”€ upload_files    # ä¸Šä¼ çš„æ–‡ä»¶
â”‚ â””â”€â”€ example.txt
â”œâ”€â”€ utils
â”‚ â””â”€â”€ common.py     # å·¥å…·
â”œâ”€â”€ .env            # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ .env.example    # ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
â”œâ”€â”€ app.py          # Streamlit åº”ç”¨
â”œâ”€â”€ main.py         # å‘½ä»¤è¡Œç¨‹åº
â”œâ”€â”€ requirements.txt    # ä¾èµ–
â”œâ”€â”€ pyproject.toml      # é¡¹ç›®é…ç½®
â”œâ”€â”€ uv.lock	        # uv é”æ–‡ä»¶
â”œâ”€â”€ run.sh          # éƒ¨ç½²è„šæœ¬
â””â”€â”€ README.md       # é¡¹ç›®è¯´æ˜
```
å…¶ä¸­ï¼š

- [models.py](./chains/models.py) æ–‡ä»¶è´Ÿè´£æ ¹æ®æä¾›çš„æ¨¡å‹åç§°åŠ è½½ç›¸åº”çš„æ¨¡å‹
- [summary.py](./chains/summary.py) ç”¨äºä»ç”¨æˆ·é—®é¢˜å’ŒèŠå¤©è®°å½•ä¸­æå–å…³é”®è¯ï¼Œå¹¶ç”Ÿæˆé«˜æ•ˆçš„æœç´¢æŸ¥è¯¢
- [generate.py](./chains/generate.py) ç”¨äºæ ¹æ®ç”¨æˆ·é—®é¢˜å’ŒèŠå¤©è®°å½•ç”Ÿæˆç­”æ¡ˆ
- [graph_state.py](./graph/graph_state.py) ç”¨äºç»´æŠ¤å›¾ç»“æ„çš„çŠ¶æ€
- [graph.py](./graph/graph.py) å®šä¹‰äº†å¤šä¸ªæ–¹æ³•ï¼Œè¡¨ç¤ºå›¾çš„ç»“æ„å’Œè¡Œä¸ºï¼Œç”¨äºå¤„ç†ä¸åŒç±»å‹çš„è¯·æ±‚

é¡¹ç›®æ­å»ºçš„å·¥ä½œæµå¦‚ä¸‹ï¼š

```mermaid
graph TD;
	__start__([<p>__start__</p>]):::first
	websearch(websearch)
	extract_keywords(extract_keywords)
	file_process(file_process)
	generate(generate)
	__end__([<p>__end__</p>]):::last
	__start__ -.-> extract_keywords;
	__start__ -.-> file_process;
	__start__ -.-> generate;
	extract_keywords -.-> generate;
	extract_keywords -.-> websearch;
	file_process --> extract_keywords;
	websearch --> generate;
	generate --> __end__;
	classDef default fill:#f2f0ff,line-height:1.2
	classDef first fill-opacity:0
	classDef last fill:#bfb6fc
```
1. `file_process` èŠ‚ç‚¹ç”¨äºå¤„ç†æ–‡ä»¶ï¼Œå°†æ–‡ä»¶åˆ†å‰²æˆ `chunk` å¹¶ä½¿ç”¨ `Embedding` æ¨¡å‹è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œå­˜å‚¨åˆ°å‘é‡å­˜å‚¨ï¼ˆ`InMemoryVectorStore`ï¼‰ä¸­ï¼›
2. `extract_keywords` èŠ‚ç‚¹ç”¨äºä»ç”¨æˆ·é—®é¢˜ä¸­æå–å…³é”®è¯ï¼Œå¹¶ç”Ÿæˆé«˜æ•ˆçš„æœç´¢æŸ¥è¯¢ï¼›
3. `websearch` èŠ‚ç‚¹ç”¨äºè”ç½‘æœç´¢ï¼Œæ ¹æ®ç”¨æˆ·é—®é¢˜å’Œç”Ÿæˆçš„å…³é”®å­—æœç´¢æŸ¥è¯¢ï¼Œä½¿ç”¨ `Tavily API` è¿›è¡Œè”ç½‘æœç´¢ï¼Œè·å–å®æ—¶ä¿¡æ¯ï¼›
4. `generate` èŠ‚ç‚¹ç”¨äºæ ¹æ®ç”¨æˆ·é—®é¢˜ã€æœç´¢æ–‡æ¡£å’ŒèŠå¤©è®°å½•ç”Ÿæˆç­”æ¡ˆï¼Œå‘é‡å¬å›åè¿›è¡Œ `rerank` æ“ä½œï¼Œä½¿ç”¨ `LLM` æ¨¡å‹è¿›è¡Œå›ç­”ï¼Œæ”¯æŒè¿ç»­å¯¹è¯å’Œæµå¼å›ç­”å±•ç¤ºï¼›
5. å…·ä½“æ­¥éª¤ä¸ºï¼šé¦–å…ˆæ ¹æ®ç”¨æˆ·çš„é€‰æ‹©è·¯ç”±åˆ°ä¸åŒçš„èŠ‚ç‚¹ï¼šé€‰æ‹©â€œç¦»çº¿å¯¹è¯â€æˆ–â€œä»£ç æ¨¡å¼â€è·¯ç”±åˆ° `generate` èŠ‚ç‚¹ï¼›
é€‰æ‹©â€œè”ç½‘æœç´¢â€è·¯ç”±åˆ° `extract_keywords` èŠ‚ç‚¹ï¼›
ç”¨æˆ·ä¸Šä¼ äº†æ–‡ä»¶åˆ™è·¯ç”±åˆ° `file_process` èŠ‚ç‚¹ã€‚

## å…¶ä»–

**NOTE:** é¡¹ç›®æ”¯æŒè§£æ `pdf`ã€`word`ã€`xlsx` ç­‰å…¶ä»–æ ¼å¼çš„æ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºéƒ¨ç½²æœåŠ¡å™¨è°ƒç”¨ `pytorch` å’Œ `cuda` çš„å†…å­˜ä¸è¶³ç›®å‰ä»…æ”¯æŒè§£æ `txt` å’Œ `md` æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ [app.py](./app.py) ä¸­ä¿®æ”¹ `file_uploader` çš„å‚æ•°æ”¯æŒå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ã€‚  

---

æ›´å¤š Agent ä¸ªäººé¡¹ç›®ä»‹ç»è¯·å‚è€ƒï¼š[Agent](https://github.com/kdjlyy/Agent)ã€‚


